<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2023b"><title>Altitude gpr:</title><style type="text/css">.rtcContent { padding: 30px; } .CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S0 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S1 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S6 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 4px 4px 0px 0px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
.S9 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     '''pressure'':',','))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% extractBetween(extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% ['dy'': &lt;Vector3r&gt; {   ' ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% '''x_val'': '],'}'), ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% 'y_val'': ',',')),str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% extractAfter( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% ['dy'': &lt;Vector3r&gt; {   ' ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% '''x_val'': '],'}'), ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% 'z_val'': ')),a(1)*ones(101,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% 'Pressure','MagnetometerX', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% 'MagnetometerZ', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     c(78:96)',c(115:132)')),str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     '''pressure'':',',')),str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     extractBetween(extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     ['dy'': &lt;Vector3r&gt; {   ' ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     '''x_val'': '],'}'), ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'y_val'': ',',')),str2double( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     extractAfter( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     extractBetween(c', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     ['dy'': &lt;Vector3r&gt; {   ' ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     '''x_val'': '],'}'), ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'z_val'': ')),l(1)*ones(101,1),['' ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'VariableNames'],{'Altitude', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'Longitude', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'Pressure','MagnetometerX', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'MagnetometerZ', ... % </span></span></div></div></div><h1  class = 'S3'><span>Altitude gpr:</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% cross-validation:</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% rng('default') % For reproducibility</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >gprMdla = fitrgp(tltra, </span><span style="color: rgb(167, 9, 245);">'Ycoordinate'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ardsquaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'FitMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'sr'</span><span >,</span><span style="color: rgb(167, 9, 245);">'PredictMethod'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'fic'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1,</span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">%   'Standardize',1, ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(0, 128, 19);">% 'Sigma',.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% fprintf('kfoldLoss = %e', kfoldLoss( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     cvgprMdl))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% ypred = kfoldPredict(cvgprMdl);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% fprintf('kfoldPredict: ');</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% fprintf('%f\t', ypred')</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >ypreda = predict(gprMdla,tlts(:,1:end </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    -1).Variables);ypreda'</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >ea = a(1)-ypreda(1) </span><span style="color: rgb(0, 128, 19);">% </span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >ea+elo</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% y = table2array(ta(2:end,end));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(tltr.Ycoordinate,</span><span style="color: rgb(167, 9, 245);">'b.'</span><span >); </span><span style="color: rgb(0, 128, 19);">% .Partition.tes</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">tight </span><span style="color: rgb(0, 128, 19);">% [0 1050 0 30]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(resubPredict(cvgprMdl));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%ypred(cvgprMdl));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'predictions'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Altitude'</span><span >)</span></span></div></div></div><h2  class = 'S5'><span>Longitude cross-validation </span><span style=' font-family: monospace;'>gpr</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >t = ta;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >rng(</span><span style="color: rgb(167, 9, 245);">'default'</span><span >) </span><span style="color: rgb(0, 128, 19);">% For reproducibility</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >cvgprMdl = fitrgp(t(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    t.Properties.VariableNames{end}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1,</span><span style="color: rgb(167, 9, 245);">'Holdout'</span><span >,0.3, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'kfoldLoss = %e'</span><span >, kfoldLoss( </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    cvgprMdl))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred = kfoldPredict(cvgprMdl);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'kfoldPredict: '</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'%f\t'</span><span >, ypred')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >y = table2array(t(2:end,end));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(y(cvgprMdl.Partition.test),</span><span style="color: rgb(167, 9, 245);">'b.'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">tight </span><span style="color: rgb(0, 128, 19);">% [0 1050 0 30]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(ypred(cvgprMdl.Partition.test));</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'predictions'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >title(ta.Properties.VariableNames{2})</span></span></div></div></div><h1  class = 'S3'><span>Optimizing hyperparameters:</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >t = ta;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >gprMdl1 = fitrgp(t(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    t.Properties.VariableNames{end}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'squaredexponential'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >rng </span><span style="color: rgb(167, 9, 245);">default</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >gprMdl2a = fitrgp(t(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    t.Properties.VariableNames{end}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'squaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'OptimizeHyperparameters'</span><span >,</span><span style="color: rgb(167, 9, 245);">'auto'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'HyperparameterOptimizationOptions'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    struct(</span><span style="color: rgb(167, 9, 245);">'AcquisitionFunctionName'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'expected-improvement-plus'</span><span >))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred1 = resubPredict(gprMdl1); ypred1(1:10)'</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred2 = resubPredict(gprMdl2a); </span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred2(1:10)'</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(t(2:end,1:end-1).Variables,t(2:end, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    end).Variables,</span><span style="color: rgb(167, 9, 245);">'r.'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(t(2:end,1:end-1).Variables, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    ypred1,</span><span style="color: rgb(167, 9, 245);">'b'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(t(2:end,1:end-1).Variables, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    ypred2, </span><span style="color: rgb(167, 9, 245);">'k'</span><span >, </span><span style="color: rgb(167, 9, 245);">'LineWidth'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >); ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Impact of Optimization'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Initial Fit'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Optimized Fit'</span><span >},</span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >t = tl;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >gprMdl1 = fitrgp(t(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    t.Properties.VariableNames{end}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'squaredexponential'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >rng </span><span style="color: rgb(167, 9, 245);">default</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >gprMdl2l = fitrgp(t(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    t.Properties.VariableNames{end}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'squaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'OptimizeHyperparameters'</span><span >,</span><span style="color: rgb(167, 9, 245);">'auto'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'HyperparameterOptimizationOptions'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    struct(</span><span style="color: rgb(167, 9, 245);">'AcquisitionFunctionName'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'expected-improvement-plus'</span><span >))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred1 = resubPredict(gprMdl1); ypred1(1:10)'</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred2 = resubPredict(gprMdl2l);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypred2(1:10)'</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(t(2:end,1:end-1).Variables,t(2:end, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    end).Variables,</span><span style="color: rgb(167, 9, 245);">'r.'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(t(2:end,1:end-1).Variables,ypred1,</span><span style="color: rgb(167, 9, 245);">'b'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(t(2:end,1:end-1).Variables,ypred2, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'k'</span><span >, </span><span style="color: rgb(167, 9, 245);">'LineWidth'</span><span >,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >); ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Impact of Optimization'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Initial Fit'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Optimized Fit'</span><span >},</span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div></div><h1  class = 'S6'><span>Others:</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdlA = fitrgp(ta(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Yaltitude'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >,</span><span style="color: rgb(167, 9, 245);">'matern32'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'FitMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'sr'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'PredictMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'fic'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1,</span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'resubLoss(gprMdA) = %e'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    resubLoss(gprMdlA))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >ypredA = resubPredict(gprMdlA); ypredA'</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(ta(2:end,:).Yaltitude,</span><span style="color: rgb(167, 9, 245);">'r.'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(ypredA,</span><span style="color: rgb(167, 9, 245);">'b'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'predictions'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">tight </span><span style="color: rgb(0, 128, 19);">% ([0 4300 0 30]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdlA = fitrgp(ta(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Yaltitude'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ardsquaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'FitMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'sr'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'PredictMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'fic'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1,</span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'resubLoss(gprMdA) = %e'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    resubLoss(gprMdA))</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ypredA = resubPredict(gprMdlA)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(ta(2:end,:).Yaltitude,</span><span style="color: rgb(167, 9, 245);">'r.'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(ypredA,</span><span style="color: rgb(167, 9, 245);">'b'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'predictions'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">tight </span><span style="color: rgb(0, 128, 19);">% ([0 4300 0 30]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdL = fitrgp(tl(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Ylongitude'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ardsquaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'FitMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'sr'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'PredictMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'fic'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1,</span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'resubLoss(gprMdL) = %e'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    resubLoss(gprMdL))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >ypredL = resubPredict(gprMdL)'</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >figure();</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(tl(2:end,:).Ylongitude,</span><span style="color: rgb(167, 9, 245);">'r.'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% ,'LineWidth',1.5</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >plot(ypredL,</span><span style="color: rgb(167, 9, 245);">'b'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >xlabel(</span><span style="color: rgb(167, 9, 245);">'x'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >ylabel(</span><span style="color: rgb(167, 9, 245);">'y'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >legend({</span><span style="color: rgb(167, 9, 245);">'Data'</span><span >,</span><span style="color: rgb(167, 9, 245);">'GPR predictions'</span><span >}, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Location'</span><span >,</span><span style="color: rgb(167, 9, 245);">'Best'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >axis </span><span style="color: rgb(167, 9, 245);">tight </span><span style="color: rgb(0, 128, 19);">% ([0 4300 0 30]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >hold </span><span style="color: rgb(167, 9, 245);">off</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >grid </span><span style="color: rgb(167, 9, 245);">on</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdL = fitrgp(tl(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Ylongitude'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ardsquaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'resubLoss(gprMdL) = %e'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    resubLoss(gprMdL))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >resubPredict(gprMdL)'</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdL = fitrgp(tl(2:end,:), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Ylongitude'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'squaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >,.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'resubLoss(gprMdL) = %e'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    resubLoss(gprMdL))</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >ypredL = resubPredict(gprMdL)'</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% gprMdl = fitrgp(tl(2:end,:),</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'Ylongitude', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'Basis','linear',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%       'FitMethod','exact',</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'PredictMethod',</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'exact', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%       'Sigma',.002)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% ypred = resubPredict(gprMdl);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >idx = randperm(100)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >tlt = tl(2:101,:)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >tltr = tl(1+sort(idx(11:100)),:)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >tlts = tl(1+sort(idx(1:10)),:)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Tnew([18,20,21],:) = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% randi([1 100],1,10)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >sigma0 = .002</span><span style="color: rgb(0, 128, 19);">%std(tltr.Ylongitude)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >sigmaF0 = sigma0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >d = size(tltr(:,1:(end-1)).Variables,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >sigmaM0 = 10*ones(d,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >gprMdl = fitrgp(tltr,</span><span style="color: rgb(167, 9, 245);">'Ylongitude'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Basis'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'constant'</span><span >,</span><span style="color: rgb(167, 9, 245);">'FitMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'exact'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(167, 9, 245);">'PredictMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'exact'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(167, 9, 245);">'ardsquaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(167, 9, 245);">'KernelParameters'</span><span >,[sigmaM0;sigmaF0], </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(167, 9, 245);">'Sigma'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >sigma0,</span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >loss(gprMdl,tlts(:, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    1:(end-1)).Variables, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    tlts( </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    :,end).Variables)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdl.KernelInformation</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% gprMdl.KernelInformation.Kernel</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% ParameterNames</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% sigmaM = gprMdl.KernelInformation.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% KernelParameters( ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     1:end-1,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% sigmaF = gprMdl.KernelInformation.</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% KernelParameters(end)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >sigma  = gprMdl.Sigma</span></span></div></div></div><h2  class = 'S5'><span>abalone</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >tbl = readtable(</span><span style="color: rgb(167, 9, 245);">'abalone.data'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Filetype'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'text'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >     </span><span style="color: rgb(167, 9, 245);">'ReadVariableNames'</span><span >,false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >tbl.Properties.VariableNames = {</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Sex'</span><span >,[</span><span style="color: rgb(167, 9, 245);">'' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Length'</span><span >],[</span><span style="color: rgb(167, 9, 245);">'' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'Diameter'</span><span >],</span><span style="color: rgb(167, 9, 245);">'Height'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >     </span><span style="color: rgb(167, 9, 245);">'WWeight'</span><span >,</span><span style="color: rgb(167, 9, 245);">'SWeight'</span><span >,</span><span style="color: rgb(167, 9, 245);">'VWeight'</span><span >,[</span><span style="color: rgb(167, 9, 245);">'' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >     </span><span style="color: rgb(167, 9, 245);">'ShWeight'</span><span >],[</span><span style="color: rgb(167, 9, 245);">'' </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >     </span><span style="color: rgb(167, 9, 245);">'NoShellRings'</span><span >]};</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >tbl(1:7,:)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >std(tbl(:,9).Variables)/sqrt(2)</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >1e-2*std(tbl(:,9).Variables)*4177</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% gprMdl = fitrgp(tbl(1:1000,:),</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'NoShellRings', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'Basis','linear',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%       'FitMethod','exact',</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'PredictMethod','exact')</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% gprMdl = fitrgp(tbl(1:100,:),</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'NoShellRings', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%     'KernelFunction',</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'ardsquaredexponential',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%       'FitMethod','sr',</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% 'PredictMethod','fic', ...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%       'Standardize',1)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >gprMdl = fitrgp(tbl,</span><span style="color: rgb(167, 9, 245);">'NoShellRings'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'KernelFunction'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'ardsquaredexponential'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'FitMethod'</span><span >,</span><span style="color: rgb(167, 9, 245);">'sr'</span><span >,</span><span style="color: rgb(167, 9, 245);">'PredictMethod'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'fic'</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >      </span><span style="color: rgb(167, 9, 245);">'Standardize'</span><span >,1)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span >n = extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">"t&gt; {   'altitude': "</span><span >,c(78:96)')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >str2double(n)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    c(78:96)',c(115:132)')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    c(115:132)',</span><span style="color: rgb(167, 9, 245);">'}'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% c(115:120)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">"a&gt; {   'altitude': "</span><span >,</span><span style="color: rgb(167, 9, 245);">','</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'''pressure'':'</span><span >,</span><span style="color: rgb(167, 9, 245);">','</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >[c(115:119)' </span><span style="color: rgb(167, 9, 245);">'''y_val'': '</span><span >]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >[</span><span style="color: rgb(167, 9, 245);">'''y_val'': ' '!'</span><span >]</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(167, 9, 245);">'''y_val'': '</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >extractBetween(extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'dy'': &lt;Vector3r&gt; {   ''x_val'': '</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'}'</span><span >), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'y_val'': '</span><span >,</span><span style="color: rgb(167, 9, 245);">','</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >extractAfter(extractBetween(c', </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'dy'': &lt;Vector3r&gt; {   ''x_val'': '</span><span >, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'}'</span><span >), </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span >    </span><span style="color: rgb(167, 9, 245);">'z_val'': '</span><span >)</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >[x,y,zone] = ll2utm(12.963553,77.651503)</span></span></div><div  class = 'S8'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>x = 7.8767e+05</div><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>y = 1.4346e+06</div><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>zone = 43</div></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% do the job!</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper outputs"><div  class = 'S7'><span style="white-space: pre"><span >[LAT,LON]=utm2ll(x,y,zone)</span></span></div><div  class = 'S8'><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>LAT = 12.9636</div><div class='variableElement' style='font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px; '>LON = 77.6515</div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S0'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% z = double(X.z); z(z==-32768 | z&lt;0) = NaN;</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% figure</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% pcolor(x,y,z); shading flat; hold on</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% contour(x,y,z,[0,0],'w')</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% hold off; axis equal; axis tight</span></span></div></div><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% xlabel('East (m)'); ylabel('North (m)')</span></span></div></div><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% title(sprintf('Sicily - UTM zone %d WGS84',zone))</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
% str2double( ...
%     extractBetween(c', ...
%     '''pressure'':',','))
% str2double( ...
    % extractBetween(extractBetween(c', ...
    % ['dy'': <Vector3r> {   ' ...
    % '''x_val'': '],'}'), ...
    % 'y_val'': ',',')),str2double( ...
    % extractAfter( ...
    % extractBetween(c', ...
    % ['dy'': <Vector3r> {   ' ...
    % '''x_val'': '],'}'), ...
    % 'z_val'': ')),a(1)*ones(101,1)
    % 'Pressure','MagnetometerX', ...
    % 'MagnetometerZ', ...

% str2double( ...
%     extractBetween(c', ...
%     c(78:96)',c(115:132)')),str2double( ...
%     extractBetween(c', ...
%     '''pressure'':',',')),str2double( ...
%     extractBetween(extractBetween(c', ...
%     ['dy'': <Vector3r> {   ' ...
%     '''x_val'': '],'}'), ...
%     'y_val'': ',',')),str2double( ...
%     extractAfter( ...
%     extractBetween(c', ...
%     ['dy'': <Vector3r> {   ' ...
%     '''x_val'': '],'}'), ...
%     'z_val'': ')),l(1)*ones(101,1),['' ...
%     'VariableNames'],{'Altitude', ...
%     'Longitude', ...
%     'Pressure','MagnetometerX', ...
%     'MagnetometerZ', ... % 
%% Altitude gpr:

% cross-validation:
% rng('default') % For reproducibility
gprMdla = fitrgp(tltra, 'Ycoordinate', ...
    'KernelFunction', ...
    'ardsquaredexponential',...
      'FitMethod','sr','PredictMethod', ...
      'fic','Standardize',1,'Sigma',.002)
% ...
    %   'Standardize',1, ...
    % 'Sigma',.002)
% fprintf('kfoldLoss = %e', kfoldLoss( ...
%     cvgprMdl))
% ypred = kfoldPredict(cvgprMdl);
% fprintf('kfoldPredict: ');
% fprintf('%f\t', ypred')
%%
ypreda = predict(gprMdla,tlts(:,1:end ...
    -1).Variables);ypreda'
ea = a(1)-ypreda(1) % 
%%
ea+elo
%%
figure();
% y = table2array(ta(2:end,end));
plot(tltr.Ycoordinate,'b.'); % .Partition.tes
axis tight % [0 1050 0 30]
xlabel('x')
ylabel('y')
hold on;
plot(resubPredict(cvgprMdl));
%ypred(cvgprMdl));
hold off;
grid on
legend({'data','predictions'}, ...
    'Location','Best');
title('Altitude')
%% Longitude cross-validation |gpr|

t = ta;
rng('default') % For reproducibility
cvgprMdl = fitrgp(t(2:end,:), ...
    t.Properties.VariableNames{end}, ...
    'Standardize',1,'Holdout',0.3, ...
    'Sigma',.002)
fprintf('kfoldLoss = %e', kfoldLoss( ...
    cvgprMdl))
ypred = kfoldPredict(cvgprMdl);
fprintf('kfoldPredict: ');
fprintf('%f\t', ypred')

figure();
y = table2array(t(2:end,end));
plot(y(cvgprMdl.Partition.test),'b.');
axis tight % [0 1050 0 30]
xlabel('x')
ylabel('y')
hold on;
plot(ypred(cvgprMdl.Partition.test));
hold off;
grid on
legend({'data','predictions'}, ...
    'Location','Best');
title(ta.Properties.VariableNames{2})
%% Optimizing hyperparameters:

t = ta;
gprMdl1 = fitrgp(t(2:end,:), ...
    t.Properties.VariableNames{end}, ...
    'KernelFunction', ...
    'squaredexponential','Sigma',.002)
rng default
gprMdl2a = fitrgp(t(2:end,:), ...
    t.Properties.VariableNames{end}, ...
    'KernelFunction', ...
    'squaredexponential',...
    'OptimizeHyperparameters','auto', ...
    'HyperparameterOptimizationOptions',...
    struct('AcquisitionFunctionName', ...
    'expected-improvement-plus'))
ypred1 = resubPredict(gprMdl1); ypred1(1:10)'
ypred2 = resubPredict(gprMdl2a); 
ypred2(1:10)'
figure();
plot(t(2:end,1:end-1).Variables,t(2:end, ...
    end).Variables,'r.');
hold on
plot(t(2:end,1:end-1).Variables, ...
    ypred1,'b');
plot(t(2:end,1:end-1).Variables, ...
    ypred2, 'k', 'LineWidth',2);
xlabel('x'); ylabel('y');

title('Impact of Optimization');
hold off
legend({'data','Initial Fit', ...
    'Optimized Fit'},'Location','Best');
%%
t = tl;
gprMdl1 = fitrgp(t(2:end,:), ...
    t.Properties.VariableNames{end}, ...
    'KernelFunction', ...
    'squaredexponential','Sigma',.002)
rng default
gprMdl2l = fitrgp(t(2:end,:), ...
    t.Properties.VariableNames{end}, ...
    'KernelFunction', ...
    'squaredexponential',...
    'OptimizeHyperparameters','auto', ...
    'HyperparameterOptimizationOptions',...
    struct('AcquisitionFunctionName', ...
    'expected-improvement-plus'))
ypred1 = resubPredict(gprMdl1); ypred1(1:10)'
ypred2 = resubPredict(gprMdl2l);
ypred2(1:10)'
figure();
plot(t(2:end,1:end-1).Variables,t(2:end, ...
    end).Variables,'r.');
hold on
plot(t(2:end,1:end-1).Variables,ypred1,'b');
plot(t(2:end,1:end-1).Variables,ypred2, ...
    'k', 'LineWidth',2);
xlabel('x'); ylabel('y');

title('Impact of Optimization');
hold off
legend({'data','Initial Fit', ...
    'Optimized Fit'},'Location','Best');
%% Others:

gprMdlA = fitrgp(ta(2:end,:), ...
    'Yaltitude', ...
    'KernelFunction','matern32',...
      'FitMethod','sr', ...
      'PredictMethod','fic', ...
      'Standardize',1,'Sigma',.002)
fprintf('resubLoss(gprMdA) = %e', ...
    resubLoss(gprMdlA))
ypredA = resubPredict(gprMdlA); ypredA'
%%
figure();
plot(ta(2:end,:).Yaltitude,'r.');
hold on
plot(ypredA,'b');
xlabel('x');
ylabel('y');
legend({'data','predictions'}, ...
    'Location','Best');
axis tight % ([0 4300 0 30]);
hold off;
grid on
%%
gprMdlA = fitrgp(ta(2:end,:), ...
    'Yaltitude', ...
    'KernelFunction', ...
    'ardsquaredexponential',...
      'FitMethod','sr', ...
      'PredictMethod','fic', ...
      'Standardize',1,'Sigma',.002)
fprintf('resubLoss(gprMdA) = %e', ...
    resubLoss(gprMdA))
ypredA = resubPredict(gprMdlA)
figure();
plot(ta(2:end,:).Yaltitude,'r.');
hold on
plot(ypredA,'b');
xlabel('x');
ylabel('y');
legend({'data','predictions'}, ...
    'Location','Best');
axis tight % ([0 4300 0 30]);
hold off;
grid on
%%
gprMdL = fitrgp(tl(2:end,:), ...
    'Ylongitude', ...
    'KernelFunction', ...
    'ardsquaredexponential',...
      'FitMethod','sr', ...
      'PredictMethod','fic', ...
      'Standardize',1,'Sigma',.002)
fprintf('resubLoss(gprMdL) = %e', ...
    resubLoss(gprMdL))
ypredL = resubPredict(gprMdL)'
%%
figure();
plot(tl(2:end,:).Ylongitude,'r.');
% ,'LineWidth',1.5
hold on
plot(ypredL,'b');
xlabel('x');
ylabel('y');
legend({'Data','GPR predictions'}, ...
    'Location','Best');
axis tight % ([0 4300 0 30]);
hold off;
grid on
%%
gprMdL = fitrgp(tl(2:end,:), ...
    'Ylongitude', ...
    'KernelFunction', ...
    'ardsquaredexponential',...
      'Sigma',.002)
fprintf('resubLoss(gprMdL) = %e', ...
    resubLoss(gprMdL))
resubPredict(gprMdL)'
%%
gprMdL = fitrgp(tl(2:end,:), ...
    'Ylongitude', ...
    'KernelFunction', ...
    'squaredexponential',...
      'Sigma',.002)
fprintf('resubLoss(gprMdL) = %e', ...
    resubLoss(gprMdL))
ypredL = resubPredict(gprMdL)'
%%
% gprMdl = fitrgp(tl(2:end,:),
% 'Ylongitude', ...
%     'Basis','linear',...
%       'FitMethod','exact',
% 'PredictMethod',
% 'exact', ...
%       'Sigma',.002)
% ypred = resubPredict(gprMdl);
%%
idx = randperm(100)
tlt = tl(2:101,:)
tltr = tl(1+sort(idx(11:100)),:)
tlts = tl(1+sort(idx(1:10)),:)
% Tnew([18,20,21],:) = [];
% randi([1 100],1,10)
sigma0 = .002%std(tltr.Ylongitude)
sigmaF0 = sigma0;
d = size(tltr(:,1:(end-1)).Variables,2);
sigmaM0 = 10*ones(d,1);
gprMdl = fitrgp(tltr,'Ylongitude', ...
    'Basis', ...
    'constant','FitMethod','exact',...
'PredictMethod','exact', ...
'KernelFunction', ...
'ardsquaredexponential',...
'KernelParameters',[sigmaM0;sigmaF0], ...
'Sigma', ...
sigma0,'Standardize',1)
loss(gprMdl,tlts(:, ...
    1:(end-1)).Variables, ...
    tlts( ...
    :,end).Variables)
%%
gprMdl.KernelInformation
% gprMdl.KernelInformation.Kernel
% ParameterNames
% sigmaM = gprMdl.KernelInformation.
% KernelParameters( ...
%     1:end-1,1)
% sigmaF = gprMdl.KernelInformation.
% KernelParameters(end)
sigma  = gprMdl.Sigma
%% abalone

tbl = readtable('abalone.data', ...
    'Filetype', ...
    'text',...
     'ReadVariableNames',false);
tbl.Properties.VariableNames = {
    'Sex',['' ...
    'Length'],['' ...
    'Diameter'],'Height',...
     'WWeight','SWeight','VWeight',['' ...
     'ShWeight'],['' ...
     'NoShellRings']};
tbl(1:7,:)
%%
std(tbl(:,9).Variables)/sqrt(2)
1e-2*std(tbl(:,9).Variables)*4177
%%
% gprMdl = fitrgp(tbl(1:1000,:),
% 'NoShellRings', ...
%     'Basis','linear',...
%       'FitMethod','exact',
% 'PredictMethod','exact')
%%
% gprMdl = fitrgp(tbl(1:100,:),
% 'NoShellRings', ...
%     'KernelFunction',
% 'ardsquaredexponential',...
%       'FitMethod','sr',
% 'PredictMethod','fic', ...
%       'Standardize',1)
%%
gprMdl = fitrgp(tbl,'NoShellRings', ...
    'KernelFunction', ...
    'ardsquaredexponential',...
      'FitMethod','sr','PredictMethod', ...
      'fic', ...
      'Standardize',1)
%%
n = extractBetween(c', ...
    "t> {   'altitude': ",c(78:96)')
str2double(n)
extractBetween(c', ...
    c(78:96)',c(115:132)')
extractBetween(c', ...
    c(115:132)','}')
% c(115:120)
extractBetween(c', ...
    "a> {   'altitude': ",',')
extractBetween(c', ...
    '''pressure'':',',')
[c(115:119)' '''y_val'': ']
['''y_val'': ' '!']
'''y_val'': '
extractBetween(extractBetween(c', ...
    'dy'': <Vector3r> {   ''x_val'': ', ...
    '}'), ...
    'y_val'': ',',')
extractAfter(extractBetween(c', ...
    'dy'': <Vector3r> {   ''x_val'': ', ...
    '}'), ...
    'z_val'': ')
%%
[x,y,zone] = ll2utm(12.963553,77.651503)
% do the job!
%%
[LAT,LON]=utm2ll(x,y,zone)
%%
% z = double(X.z); z(z==-32768 | z<0) = NaN;
% figure
% pcolor(x,y,z); shading flat; hold on
% contour(x,y,z,[0,0],'w')
% hold off; axis equal; axis tight
% xlabel('East (m)'); ylabel('North (m)')
% title(sprintf('Sicily - UTM zone %d WGS84',zone))
##### SOURCE END #####
-->
</div></body></html>